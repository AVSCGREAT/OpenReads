$def with (user, mybooks, public=False, owners_page=False, counts=None, lists=None)

$ component_times = {}
$ component_times['TotalTime'] = time()

$ username = user.key.split('/')[-1]

<div class="mybooks-options">
  <span class="chip value-chip chip--selectable">
    <a data-ol-link-track="MyBooksSidebar|ReadingStats"
       href="/account/books/already-read/stats">$_('My Reading Stats')</a>
  </span>
  <span class="chip value-chip chip--selectable">
    <a data-ol-link-track="MyBooksSidebar|ImportExport"
       href="/account/import">$_("Import & Export Options")</a>
  </span>
</div>

$code:
    def compact_carousel(key, title, url):
        books = mybooks[key].docs
        count = mybooks[key].total_results
        return render_template("books/custom_carousel", **{
            "books": books,
            "title": "%s (%d)" % (title, count),
            "url": url,
            "key": key,
            "min_books": 1,
            "load_more": None,
            "compact_mode": True,
            "test": False
        })

$if mybooks['loans'].docs:
  $:compact_carousel("loans", _('My Loans'), url="/account/loans")

$if mybooks['currently-reading'].docs:
  $:compact_carousel("currently-reading", _('Currently Reading'), url="/account/books/currently-reading")
$else:
  <div class="carousel-section-header">
    <h2 class="home-h2"><a name="currently-reading" href="/account/books/currently-reading">$_('Currently Reading (0)')</a></h2>
  </div>
  <li>$_('No books are on this shelf')</li>

$if mybooks['want-to-read'].docs:
  $:compact_carousel("want-to-read", _('Want to Read'), url="/account/books/want-to-read")
$else:
  <div class="carousel-section-header">
    <h2 class="home-h2"><a name="want-to-read" href="/account/books/want-to-read">$_('Want to Read (0)')</a></h2>
  </div>
  <li>$_('No books are on this shelf')</li>

$if mybooks['already-read'].docs:
  $:compact_carousel("already-read", _('Already Read'), url="/account/books/already-read")
$else:
  <div class="carousel-section-header">
    <h2 class="home-h2"><a name="already-read" href="/account/books/already-read">$_('Already Read (0)')</a></h2>
  </div>
  <li>$_('No books are on this shelf')</li>
